## Кратчайшие пути

## A. Алгоритм Флойда

Полный ориентированный взвешенный граф задан матрицей смежности. Постройте матрицу кратчайших путей между его вершинами. Гарантируется, что в графе нет циклов отрицательного веса.

В первой строке вводится единственное число _N_ (1 ≤ _N_ ≤ 100) – количество вершин графа. В следующих _N_ строках по _N_ чисел задается матрица смежности графа (_j_-ое число в _i_-ой строке соответствует весу ребра из вершины _i_ в вершину _j_). Все числа по модулю не превышают 100. На главной диагонали матрицы – всегда нули.

Выведите _N_ строк по _N_ чисел – матрицу кратчайших расстояний между парами вершин. _j_-ое число в _i_-ой строке должно быть равно весу кратчайшего пути из вершины _i_ в вершину _j_.

**Примеры**

Входные данные
```
4
0 5 9 100
100 0 2 8
100 100 0 7
4 100 100 0
```
Результат работы
```
0 5 7 13
12 0 2 8
11 16 0 7
4 9 11 0
```

### B. Алгоритм Дейкстры

Правительство некоторой всем известной страны решило глобально перестроить дорожную систему – оно уже успело разрушить все дороги, и теперь нужно выстроить дорожную сеть заново. Новые двусторонние дороги можно строить между любыми двумя городами, и стоимость постройки дороги равна расстоянию между соответствующими городами. Однако в некоторых случаях ландшафт позволяет построить дорогу за другую цену, такие пары городов называются особыми. Правительство решило первым делом соединить два главных города данной страны – _А_ и _Б_. Вам поручили разработать план постройки дорог, при котором суммарная стоимость всех построенных дорог будет минимально возможной, и при этом по построенным дорогам можно будет добраться из города _А_ в город _Б_.

Первая строка содержит число _N_ – количество городов в стране (1 ≤ _N_ ≤ 10^4). Каждая из последующих _N_ строк содержит по два целых числа, _x_i_ и _y_i_ – координаты соответствующего города (|_x_i_|, |_y_i_| ≤ 10^6). Далее содержится число _M_ – количество особых пар городов (0 ≤ _M_ ≤ min(10^4, _N_ * (_N_ − 1) / 2)). Далее в _M_ строках содержится описание особых дорог, каждое состоит из трех целых чисел: _u_, _v_ – пара различных городов, между которыми проходит особая дорога, и _w_ – стоимости постройки соответствующей дороги (1 ≤ _u_, _v_ ≤ _N_, 0 ≤ _w_ ≤ 10^6). В последней строке содержатся номера городов _А_ и _Б_ (от _1_ до _N_).

Выведите одно число – искомую минимальную длину. Ваш ответ должен отличаться от правильного не более чем на 10^−5.

**Примеры**

Входные данные
```
4
1 1
0 0
1 0
0 1
1
1 2 100
2 1
```
Результат работы
```
2.0000000000
```

### C. Система Непересекающихся Множеств

Одно разбросанное на островах Океании государство решило создать сеть автомобильных дорог (вернее, мостов). По каждому мосту можно перемещаться в обе стороны. Был разработан план очередности строительства мостов и известно, что после постройки всех мостов можно будет проехать по ним с каждого острова на каждый (возможно, через некоторые промежуточные острова).

Однако, этот момент может наступить до того, как будут построены все мосты. Ваша задача состоит в нахождении такого минимального количества мостов, после постройки которого (в порядке строительства по плану) можно будет попасть с любого острова на любой другой.

При решении задачи реализуйте класс `TDisjointSetUnion` с публичными методами `FindSet` (константный) и `UnionSets`. Должна быть реализована эвристика сжатия путей, а также случайный выбор родителя при объединении множеств или на основе ранговой эвристики.

Первая строка содержит два числа: _N_ - число островов (1 ≤ _N_ ≤ 100 000) и _M_ – количество мостов в плане (1 ≤ _M_ ≤ 200 000). В каждой следующей строке содержится описание моста – два числа _x_ и _y_ (0 ≤ _x_, _y_ < _N_) – номера соединяемых островов.

Выведите в выходной файл одно число – минимальное количество построенных мостов, по которым можно попасть с любого острова на любой.

**Примеры**

Входные данные
```
4 5
0 1
0 2
1 2
2 3
3 0
```
Результат работы
```
4
```

### D. Минимальное Остовное Дерево

Печатной схемой называется плоская поверхность содержащей узлы и перемычки, соединяющие пары узлов. Мы будем рассматривать печатные схемы специального вида, где все узлы расположены в узлах прямоугольной сетки, а перемычки (вертикальные или горизонтальные) соединяют пары соседних узлов. Печатная схема называется связной, если любые два узла соединены друг с другом последовательностью перемычек. На вход дается печатная схема, где некоторые соседние узлы уже соединены перемычками. К ней необходимо добавить некоторое количество перемычек таким образом, чтобы схема стала связной. Стоимость вертикальной перемычки – _1_, а горизонтальной – _2_. Ваша программа должна по начальной печатной схеме определить количество добавляемых перемычек, минимальную стоимость такого добавления, а также вывести сами добавляемые перемычки.

Первая строка входного файла содержит два натуральных числа _N_ и _M_ – количество строк (1 ≤ _N_ ≤ 100) и количество столбцов (1 ≤ _M_ ≤ 100) соответственно. Каждый узел определяется своими координатами, нумерация начинается с верхнего левого угла (координаты `(1, 1)`). Далее дается описание решетки в виде _N_ строк по _M_ чисел. Каждое число обозначает связь узла `(i, j)` с узлами `(i + 1, j)` и `(i, j + 1)` в следующем формате: _0_ – узел `(i, j)` не соединен ни с одним из узлов `(i + 1, j)` и `(i, j + 1)`. _1_ – узел `(i, j)` соединен только с узлом `(i + 1, j)`, _2_ – узел `(i, j)` соединен только с узлом `(i, j + 1)`, _3_ – узел `(i, j)` соединен и с узлом `(i + 1, j)`, и с узлом `(i, j + 1)`.

Первая строка должна содержать два числа _K_ и _V_ – количество добавленных перемычек и стоимость добавления соответственно. Каждая из следующих _K_ строк должна содержать описание добавленной перемычки в формате _i_, _j_, _d_, где `(i, j)` – координаты начального узла, а _d_ может принимать значения _1_ или _2_. _d_ = 1 обозначает, что соединены узлы `(i, j)` и `(i + 1, j)`, _d_ = 2 – узлы `(i, j)` и `(i, j + 1)`. Если решений несколько – выведите любое из них.

**Примеры**

Входные данные
```
4 5
2 1 1 2 1
0 3 0 1 0
3 0 0 3 1
0 2 0 2 0
```
Результат работы
```
5 6
1 1 1
2 3 1
3 3 1
4 3 2
2 5 1
```

### E. 0-1 BFS

В городе Н при невыясненных обстоятельствах территория одного из заводов превратилась в аномальную зону. Все подъезды к территории были перекрыты, а сама она получила название промзоны. В промзоне находятся _N_ зданий, некоторые из них соединены дорогами. По любой дороге можно перемещаться в обоих направлениях.

Начинающий сталкер получил задание добраться до склада в промзоне. Он нашел в электронном архиве несколько карт территории промзоны. Так как карты составлялись разными людьми, то на каждой из них есть информация только о некоторых дорогах промзоны. Одна и та же дорога может присутствовать на нескольких картах.

В пути сталкер может загружать из архива на мобильный телефон по одной карте. При загрузке новой карты предыдущая в памяти телефона не сохраняется. Сталкер может перемещаться лишь по дорогам, отмеченным на карте, загруженной на данный момент. Каждая загрузка карты стоит _1_ рубль. Для минимизации расходов сталкеру нужно выбрать такой маршрут, чтобы как можно меньшее число раз загружать карты. Сталкер может загружать одну и ту же карту несколько раз, при этом придется заплатить за каждую загрузку. Изначально в памяти мобильного телефона нет никакой карты.

Требуется написать программу, которая вычисляет минимальную сумму расходов, необходимую сталкеру, чтобы добраться от входа в промзону до склада.

В первой строке входных данных содержатся два натуральных числа _N_ и _K_ (2 ≤ _N_ ≤ 2000; 1 ≤ _K_ ≤ 2000) — количество зданий промзоны и количество карт соответственно. Вход в промзону находится в здании с номером _1_, а склад — в здании с номером _N_.

В последующих строках находится информация об имеющихся картах. Первая строка описания _i_-ой карты содержит число _r_i_ — количество дорог, обозначенных на _i_-ой карте. Затем идут _r_i_ строк, содержащие по два натуральных числа _a_ и _b_ (1 ≤ _a_, _b_ ≤ _N_; _a_ ≠ _b_), означающих наличие на _i_-ой карте дороги, соединяющей здания _a_ и _b_. Суммарное количество дорог, обозначенных на всех картах, не превышает 300'000 (_r_1_ + _r_2_ + _..._ + _r_K_ ≤ 300 000).

Выведите одно число — минимальную сумму расходов сталкера. В случае, если до склада добраться невозможно, выведите число _-1_.

**Примеры**

Входные данные
```
12 4
4
1 6
2 4
7 9
10 12
3
1 4
7 11
3 6
3
2 5
4 11
8 9
5
3 10
10 7
7 2
12 3
5 12
```
Результат работы
```
3
```

### F. Алгоритм Дейкстры за O(M log M)

Сергей Андреевич с Михаилом Сергеевичем часто ездят в разные города мира на конференции по математической кибернетике — науке, которой еще Яблонский занимался! С недавних пор они решили перемещаться на личном автомобиле Михаила. Ни для кого не секрет, что такие поездки занимают очень много времени, а смартфон при активном использовании Яндекс.Навигатора может разрядиться уже после нескольких сотен километров. Но, как известно, у Ложкина под лысиной функционирует ПЛИСина! Осталось только разработать подходящее программное обеспечение. Но не беспокойтесь, на Verilog ничего писать не придется, т.к. студенты прошлых лет уже написали полноценный MIPS-процессор, и на нем даже запускается Linux. А недавно, пока Сергей Андреевич спал, Владислав Васильевич собрал на нем самый свежий компилятор gcc.

Вам дано описание дорожной сети мира. Ваша задача – найти длину кратчайшего пути между городами _А_ и _B_.

Сеть дорог задана во входном файле следующим образом: первая строка содержит числа _N_ и _K_ (1 ≤ _N_ ≤ 100000, 0 ≤ _K_ ≤ 300000), где _K_ – количество дорог. Каждая из следующих _K_ строк содержит описание дороги с двусторонним движением – три целых числа _a_i_, _b_i_ и _l_i_ (1 ≤ _a_i_, _b_i_ ≤ _N_, 1 ≤ _l_i_ ≤ 10^6). Это означает, что имеется дорога длины _l_i_, которая ведет из города _a_i_ в город _b_i_. В последней строке находятся два числа _А_ и _В_ – номера городов, между которыми надо посчитать кратчайшее расстояние (1 ≤ _A_, _B_ ≤ _N_).

Вы должны вывести в выходной файл единственное число – расстояние между требуемыми городами. Если по дорогам от города _А_ до города _В_ доехать невозможно, выведите _-1_.

**Примеры**

Входные данные
```
6 4
1 2 7
2 4 8
4 5 1
4 3 100
3 1
```
Результат работы
```
115
```
